#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–æ–µ–∫—Ç–∞
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –Ω–æ–≤–æ–≥–æ —á–∞—Ç–∞ —Å –∞–≥–µ–Ω—Ç–æ–º

echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–æ–µ–∫—Ç–∞ –ü–æ–Ω—è—Ç–Ω–æ MiniApp TG"
echo "=============================================="

# –ü—Ä–æ–≤–µ—Ä–∫–∞ git —Å—Ç–∞—Ç—É—Å–∞
echo "üìã Git —Å—Ç–∞—Ç—É—Å:"
git status --porcelain
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥-—Å–µ—Ä–≤–µ—Ä–∞
echo "üåê –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥-—Å–µ—Ä–≤–µ—Ä–∞:"
if curl -s http://localhost:3030/health > /dev/null; then
    echo "‚úÖ –õ–æ–≥-—Å–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 3030"
else
    echo "‚ùå –õ–æ–≥-—Å–µ—Ä–≤–µ—Ä –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 3030"
    echo "üí° –ó–∞–ø—É—Å—Ç–∏—Ç–µ: node log-server.cjs &"
fi
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ª–æ–≥–æ–≤
echo "üìä –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ª–æ–≥–∏:"
if ls logs/log-server-*.log 1> /dev/null 2>&1; then
    echo "–ü–æ—Å–ª–µ–¥–Ω–∏–µ 5 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤:"
    tail -n 5 logs/log-server-*.log | grep -E "\[(LOG|ERROR|WARN|INFO)\]" | tail -3
else
    echo "‚ùå –§–∞–π–ª—ã –ª–æ–≥–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"
fi
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤
echo "üîå –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ—Ä—Ç—ã:"
lsof -i :3030 2>/dev/null || echo "–ü–æ—Ä—Ç 3030 —Å–≤–æ–±–æ–¥–µ–Ω"
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞
echo "üìÅ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã:"
[ -f "index.html" ] && echo "‚úÖ index.html (—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –æ—à–∏–±–æ–∫)" || echo "‚ùå index.html –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"
[ -f "src/App.tsx" ] && echo "‚úÖ src/App.tsx (–æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç)" || echo "‚ùå src/App.tsx –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"
[ -f "log-server.cjs" ] && echo "‚úÖ log-server.cjs (—Å–µ—Ä–≤–µ—Ä –ª–æ–≥–æ–≤)" || echo "‚ùå log-server.cjs –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"
[ -f "AGENT_CONTEXT.md" ] && echo "‚úÖ AGENT_CONTEXT.md (–∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤)" || echo "‚ùå AGENT_CONTEXT.md –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"
echo ""

echo "üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:"
echo "1. –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ AGENT_CONTEXT.md"
echo "2. –ù–ï –õ–û–ú–ê–ô–¢–ï –°–£–©–ï–°–¢–í–£–Æ–©–ò–ô –ö–û–î!"
echo "3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä Cursor –¥–ª—è —á—Ç–µ–Ω–∏—è –ª–æ–≥–æ–≤"
echo "4. –ù–ï –î–ï–ü–õ–û–ô–¢–ï –í VERCEL –ë–ï–ó –ö–û–ú–ê–ù–î–´ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø!"
echo "5. –†–∞–±–æ—Ç–∞–π—Ç–µ —Ç–æ–ª—å–∫–æ —Å –ª–æ–∫–∞–ª—å–Ω—ã–º —Ö–æ—Å—Ç–æ–º http://localhost:3030"
echo ""

echo "‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞"
